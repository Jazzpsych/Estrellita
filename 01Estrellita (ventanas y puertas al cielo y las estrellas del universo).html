<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para mi Estrellita ğŸŒŸ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #fce4ec;
            color: #333;
            margin: 0;
            padding: 10px;
        }
        h1 {
            color: #d81b60;
            margin: 10px 0;
        }
        select, button, input {
            padding: 8px;
            margin: 5px;
            font-size: 16px;
        }
        #mensaje, #poema {
            font-size: 20px;
            margin-top: 15px;
            font-weight: bold;
            color: #880e4f;
        }
        #poema {
            font-style: italic;
            white-space: pre-wrap;
        }
        .imagenes-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 15px;
        }
        .imagen-item {
            margin-bottom: 15px;
        }
        .imagen-item img {
            width: 100%;
            max-width: 300px;
            border-radius: 5px;
        }
        .imagen-emojis {
            margin-top: 5px;
            font-size: 20px;
        }
        .imagen-emojis a {
            text-decoration: none;
            color: #d81b60;
            margin-left: 10px;
        }
        .imagen-emojis a:hover {
            color: #880e4f;
        }
        .mensaje-item {
            text-align: left;
            margin: 8px 0;
            padding: 5px;
            background-color: #f8f8f8;
            border-radius: 5px;
        }
        #loginError {
            color: red;
        }
        #contenido {
            max-width: 600px;
            margin: 0 auto;
        }
        .password-container {
            position: relative;
            display: inline-block;
        }
        #togglePassword {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
        }
        .contador-emociones {
            margin: 15px auto;
            text-align: left;
            max-width: 400px;
            background-color: #f8bbd0;
            padding: 10px;
            border-radius: 10px;
            display: none;
        }
        .contador-item {
            margin: 5px 0;
            display: flex;
            justify-content: space-between;
        }
        .contador-label {
            font-weight: bold;
            color: #880e4f;
        }
        .contador-valor {
            font-weight: bold;
            background-color: white;
            padding: 2px 8px;
            border-radius: 10px;
            min-width: 30px;
            text-align: center;
        }
        #mensajeInput {
            width: 70%;
            resize: vertical;
            min-height: 40px;
            max-height: 100px;
        }
        .historial-item {
            margin: 5px 0;
            padding: 5px;
            background-color: #f8f8f8;
            border-radius: 5px;
        }
        #admin-info {
            background-color: #e8f5e9;
            border: 1px solid #81c784;
            padding: 10px;
            margin: 10px 0;
            text-align: left;
            border-radius: 5px;
            display: none;
        }
        .chat-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }
        #chat {
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            height: 60vh;
            padding: 10px;
            width: 100%;
            box-sizing: border-box;
        }
        .input-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            margin-top: 5px;
            padding: 0 10px;
            box-sizing: border-box;
        }
        #enviarMensaje {
            margin-left: 5px;
        }
        @media (max-width: 600px) {
            body { padding: 5px; }
            h1 { font-size: 24px; }
            select, button, input { padding: 6px; margin: 3px; font-size: 14px; }
            #mensaje, #poema { font-size: 18px; }
            #chat { height: 50vh; }
            #mensajeInput { width: 65%; min-height: 30px; font-size: 14px; }
            #enviarMensaje { padding: 6px 10px; font-size: 14px; }
            .input-container { margin-top: 3px; }
            .contador-emociones { max-width: 100%; padding: 8px; }
            #historial-container { max-height: 150px; }
            .imagen-item { margin-bottom: 10px; }
            .imagen-item img { max-width: 250px; }
            .imagen-emojis { font-size: 18px; }
        }
    </style>
</head>
<body>
    <h1>Para mi Estrellita ğŸŒŸ</h1>

    <div id="loginContainer">
        <h2>Iniciar SesiÃ³n</h2>
        <input type="email" id="email" placeholder="Correo electrÃ³nico" required>
        <div class="password-container">
            <input type="password" id="password" placeholder="ContraseÃ±a" required>
            <button type="button" id="togglePassword">ğŸ‘</button>
        </div>
        <button id="login">Iniciar sesiÃ³n</button>
        <p id="loginError"></p>
    </div>

    <div id="contenido" style="display: none;">
        <button id="logout" style="background-color: red; color: white; padding: 10px; border: none; cursor: pointer;">Cerrar SesiÃ³n</button>

        <div id="admin-info">
            <h3>Panel de administrador</h3>
            <p id="usuario-actual-info">Usuario actual: <strong id="usuario-nombre">No detectado</strong></p>
            <p id="admin-status-info">Estado de administrador: <strong id="admin-status">No</strong></p>
        </div>

        <p>Â¿CÃ³mo te sientes hoy, mi niÃ±a?</p>
        <select id="emocion">
            <option value="feliz">Feliz ğŸ˜Š</option>
            <option value="triste">Triste ğŸ˜”</option>
            <option value="estresada">Estresada ğŸ˜µâ€ğŸ’«</option>
            <option value="cansada">Cansada ğŸ¥±</option>
            <option value="extraÃ±andote">ExtraÃ±Ã¡ndote ğŸ¥º</option>
            <option value="pensandoEnTi">Pensando en ti ğŸ’­â¤ï¸</option>
            <option value="conGanasDeVerte">Con ganas de verte ğŸ¥°</option>
            <option value="conGanasDePensar">Con ganas de "pensar" ğŸ˜</option>
        </select>
        <button onclick="mostrarMensaje()">Ver mensaje</button>
        <button onclick="mostrarPoema()">Poema del dÃ­a</button>
        <p id="mensaje"></p>
        <p id="poema"></p>

        <div id="contador-emociones" class="contador-emociones">
            <h3>Contador de Emociones â¤ï¸</h3>
            <div id="contadores-container"></div>
        </div>

        <div id="historial-emociones" class="contador-emociones">
            <h3>Historial de Emociones â±ï¸</h3>
            <div id="historial-container" style="max-height: 200px; overflow-y: auto;"></div>
        </div>

        <div class="imagenes-container">
            <div class="imagen-item">
                <img src="https://i.imgur.com/8jWcK6P.png" alt="Piano con notas musicales">
                <div class="imagen-emojis">
                    <span>â¤ï¸</span>
                    <a href="https://youtu.be/M7k5tjw3-0M" target="_blank">ğŸµâ¤ï¸</a>
                </div>
            </div>
            <div class="imagen-item">
                <img src="https://i.imgur.com/qO3JLoN.jpeg" alt="Estrellita especial">
                <div class="imagen-emojis">
                    <span>â¤ï¸</span>
                    <a href="https://www.youtube.com/watch?v=ITbjjKDDSO0&pp=ygUgbGEgbWVqb3IgdmVyc2nDs24gam9zZSB5IGVsIHRvcm8%3D" target="_blank">ğŸµâ¤ï¸</a>
                </div>
            </div>
        </div>

        <h2>Chat con Estrellita ğŸ’¬</h2>
        <div class="chat-container">
            <div id="chat"></div>
            <div class="input-container">
                <textarea id="mensajeInput" placeholder="Escribe un mensaje..." rows="2"></textarea>
                <button id="enviarMensaje">Enviar</button>
            </div>
        </div>
    </div>

    <script>
        const frases = {
            feliz: [
                "Me encanta saber que estÃ¡s feliz, mi niÃ±a. Siempre quiero verte asÃ­. ğŸŒ¸",
                "Tu felicidad es mi felicidad. Que nunca te falte una sonrisa. ğŸ˜Š",
                "Hoy el sol brilla mÃ¡s porque tÃº estÃ¡s feliz. â˜€ï¸ğŸ’–",
                "No hay nada que me haga mÃ¡s feliz que verte sonreÃ­r. ğŸ’«",
                "Quisiera guardar este momento en un frasco y abrirlo cuando lo necesitemos. ğŸ€",
                "Cuando eres feliz, haces del mundo un lugar mejor. ğŸŒâœ¨",
                "Si tu alegrÃ­a tuviera sonido, serÃ­a mi canciÃ³n favorita. ğŸ¶ğŸ’–",
                "Disfruta este momento, porque te lo mereces. ğŸ’•",
                "Cada risa tuya es un regalo para mÃ­. ğŸğŸ˜Š",
                "Me encanta la forma en que iluminas todo con tu alegrÃ­a. âœ¨",
                "Que este dÃ­a sea solo el comienzo de una larga felicidad. ğŸ’›",
                "Estar feliz es como volar sin alas, Â¿verdad? ğŸ•Šï¸",
                "Recuerda siempre estos momentos y guÃ¡rdalos en tu corazÃ³n. ğŸ’–",
                "Si supieras lo hermosa que te ves cuando sonrÃ­es... ğŸ¥°",
                "OjalÃ¡ pudiera congelar este instante y guardarlo para siempre. â„ï¸â¤ï¸",
                "Mi deseo es que nunca pierdas esa luz que llevas dentro. ğŸŒŸ",
                "Que cada dÃ­a sea mÃ¡s brillante que el anterior. âœ¨ğŸŒˆ",
                "Tu felicidad es contagiosa, y me encanta ser contagiado. ğŸ˜†ğŸ’–",
                "No importa lo que pase, siempre hay motivos para sonreÃ­r. ğŸ˜Š",
                "Hoy es un dÃ­a perfecto porque tÃº lo hiciste asÃ­. ğŸŒ·ğŸ’–",
                "Que cada paso que des estÃ© lleno de alegrÃ­a. ğŸš€",
                "SonrÃ­e, porque te mereces toda la felicidad del mundo. ğŸ˜",
                "Si el mundo tuviera mÃ¡s personas como tÃº, serÃ­a un mejor lugar. ğŸŒğŸ’–",
                "QuÃ© bonito es verte tan radiante. ğŸŒâœ¨",
                "La felicidad es un camino, y tÃº lo recorres con gracia. ğŸš¶â€â™€ï¸ğŸ’›",
                "Vive el momento, porque la felicidad estÃ¡ en los pequeÃ±os detalles. ğŸˆ",
                "Me siento afortunado de compartir tu felicidad. ğŸ’•",
                "Un dÃ­a lleno de alegrÃ­a es un dÃ­a bien vivido. ğŸŒ¸",
                "Que tu sonrisa nunca se apague, porque ilumina mi mundo. ğŸ’–",
                "No dejes que nada ni nadie apague esta felicidad. Â¡Brilla! ğŸŒŸ"
            ],
            triste: [
                "Recuerda que, pase lo que pase, siempre estarÃ© para ti. ğŸ’•",
                "Las nubes pasan, pero el cielo sigue ahÃ­. Y yo tambiÃ©n estarÃ© siempre contigo. ğŸŒ§ï¸â¤ï¸",
                "Si estÃ¡s triste, piensa en lo mucho que significas para mÃ­. ğŸ’–",
                "No importa la tormenta, el sol siempre vuelve a brillar. â˜€ï¸",
                "A veces, llorar tambiÃ©n es parte de sanar. Estoy aquÃ­ para ti. ğŸ’™",
                "Te mando un abrazo que dure hasta que vuelvas a sonreÃ­r. ğŸ¤—ğŸ’–",
                "No tienes que ser fuerte todo el tiempo. EstÃ¡ bien sentirse asÃ­. ğŸ’•",
                "Aunque no lo parezca, este momento difÃ­cil pasarÃ¡. ğŸŒˆ",
                "Si necesitas un hombro en el que apoyarte, siempre tendrÃ¡s el mÃ­o. ğŸ’›",
                "Me gustarÃ­a poder quitarte toda la tristeza con un solo abrazo. ğŸ«‚",
                "Respira hondo y recuerda lo fuerte que eres. ğŸŒ¸",
                "No hay tristeza eterna, solo momentos que nos enseÃ±an. ğŸ’–",
                "Aunque no lo creas, todo esto tiene un propÃ³sito. ğŸŒŸ",
                "Cuando todo se sienta oscuro, piensa en la luz que llevas dentro. ğŸ”¥",
                "Incluso la noche mÃ¡s larga tiene su amanecer. ğŸŒ…",
                "Recuerda cuÃ¡nto has logrado y lo increÃ­ble que eres. ğŸ’•",
                "Si supieras lo mucho que vales, nunca estarÃ­as triste. ğŸ’–",
                "Eres mÃ¡s fuerte de lo que crees, y yo creo en ti. ğŸŒ¸",
                "Siempre hay un nuevo comienzo esperando por ti. ğŸ’«",
                "No estÃ¡s sola. AquÃ­ estoy, contigo. ğŸ’•"
            ],
            estresada: [
                "Respira hondo, mi amor. Todo estarÃ¡ bien. ğŸ’•",
                "No tienes que hacerlo todo de una vez, paso a paso. ğŸ¦‹",
                "Cierra los ojos por un momento y deja que el estrÃ©s se disuelva. âœ¨",
                "Incluso las tormentas mÃ¡s fuertes pasan, y esta tambiÃ©n lo harÃ¡. â›ˆï¸",
                "Si el mundo pesa demasiado, deja que comparta la carga contigo. ğŸ’›",
                "Hoy puede ser difÃ­cil, pero eres mÃ¡s fuerte de lo que crees. ğŸ’ª",
                "No dejes que el estrÃ©s te haga olvidar lo increÃ­ble que eres. ğŸ’–",
                "Descansa un momento, tu bienestar es lo mÃ¡s importante. ğŸŒ¿",
                "Un respiro profundo puede hacer maravillas. Inhalaâ€¦ Exhalaâ€¦ ğŸŒ¬ï¸",
                "Recuerda que siempre puedes contar conmigo. ğŸ«‚ğŸ’–",
                "Cada desafÃ­o te estÃ¡ haciendo mÃ¡s fuerte, aunque no lo parezca. ğŸ‹ï¸â€â™€ï¸",
                "No dejes que la presiÃ³n te quite la alegrÃ­a de cada dÃ­a. ğŸ’«",
                "EstÃ¡ bien parar un momento y simplemente respirar. â³",
                "Hoy enfÃ³cate en lo que puedes controlar y deja ir el resto. ğŸˆ",
                "Incluso cuando sientas que todo se descontrola, aquÃ­ estoy yo para ti. ğŸ’•",
                "Prioriza lo mÃ¡s importante: tÃº. âœ¨ğŸ’–",
                "Un mal dÃ­a no significa una mala vida. â˜€ï¸ğŸ’›",
                "TÃ³mate tu tiempo, las prisas no llevan a nada bueno. ğŸš¶â€â™€ï¸",
                "A veces, un pequeÃ±o descanso hace toda la diferencia. ğŸŒŠ",
                "Date permiso para desconectar y recargar energÃ­as. ğŸ”‹",
                "No dejes que el estrÃ©s te impida disfrutar las pequeÃ±as cosas. ğŸŒ·",
                "Recuerda por quÃ© empezaste, pero tambiÃ©n permÃ­tete descansar. ğŸŒŸ",
                "Tu esfuerzo es admirable, pero tambiÃ©n lo es tu bienestar. ğŸ’–",
                "A veces, lo mejor que puedes hacer es dejarlo ir y seguir adelante. ğŸ•Šï¸",
                "La calma llegarÃ¡, solo aguanta un poco mÃ¡s. ğŸ’›",
                "Si hoy sientes que el mundo pesa, recuerda que no lo cargas sola. ğŸ«‚",
                "EstÃ¡s haciendo lo mejor que puedes, y eso ya es suficiente. ğŸŒ¸",
                "Eres fuerte, incluso cuando no lo sientas. ğŸ’ª",
                "TÃ³mate un respiro, la vida no es una carrera. ğŸŒ¿",
                "MaÃ±ana serÃ¡ un nuevo dÃ­a, lleno de oportunidades. ğŸŒ…"
            ],
            cansada: [
                "Cierra los ojos un momento, descansa, yo cuidarÃ© de ti. ğŸ’•",
                "A veces lo mejor que puedes hacer es dormir y empezar de nuevo maÃ±ana. ğŸŒ™",
                "No tienes que hacerlo todo hoy, tÃ³mate tu tiempo. â³",
                "Descansa, mi amor. Nada es mÃ¡s importante que tu bienestar. ğŸŒ¸",
                "Dormir es como reiniciar el alma. Date permiso de hacerlo. ğŸ”„ğŸ’–",
                "Si el dÃ­a fue agotador, permÃ­tete un momento de tranquilidad. ğŸŒ¿",
                "Apoya la cabeza, cierra los ojos y deja que el cansancio se disuelva. ğŸ’¤",
                "Te mando un abrazo lleno de calma y paz. ğŸ¤—ğŸ’›",
                "La fatiga no define lo increÃ­ble que eres. ğŸ’«",
                "Un dÃ­a a la vez, mi amor. No hay prisa, descansa. ğŸ’•",
                "Recuerda que hasta las estrellas necesitan descansar. ğŸŒŸ",
                "Tu cuerpo y mente te estÃ¡n pidiendo un respiro. EscÃºchalos. ğŸ¦‹",
                "El descanso tambiÃ©n es productividad. ğŸ›Œâœ¨",
                "TÃ³mate un momento para ti, lo mereces. ğŸ€",
                "No importa lo que pase, todo puede esperar. Tu bienestar primero. ğŸ’›",
                "No te sientas culpable por descansar, es necesario. ğŸŒ¿",
                "Un cafÃ©, una siesta o una pausa pueden hacer maravillas. â˜•ğŸ’–",
                "RelÃ¡jate, respira y deja que la calma entre en ti. ğŸŒŠ",
                "Cuando despiertes, verÃ¡s las cosas con mÃ¡s claridad. ğŸŒ…",
                "Hoy te ganaste el derecho de descansar sin remordimientos. ğŸ’•",
                "A veces, descansar es la mejor forma de seguir adelante. ğŸš¶â€â™€ï¸ğŸ’›",
                "Cierra los ojos, piensa en algo lindo y deja que el sueÃ±o te abrace. ğŸ’–",
                "No hay prisa, todoåºå¤§çš„ aquÃ­ cuando despiertes. ğŸŒ¸",
                "MaÃ±ana serÃ¡ un nuevo dÃ­a, lleno de oportunidades. ğŸŒŸ",
                "Cuando estÃ©s lista, sigue adelante. Por ahora, descansa. ğŸ’¤",
                "Deja que el cansancio se disuelva y la tranquilidad tome su lugar. ğŸ’•",
                "Un buen descanso puede cambiar todo. ğŸŒ™ğŸ’–",
                "Nadie puede ser fuerte todo el tiempo. PermÃ­tete un respiro. ğŸ’›",
                "Me gustarÃ­a estar ahÃ­ para abrazarte hasta que duermas. ğŸ¤—",
                "No tienes que cargar el mundo, solo descansar y ser tÃº. âœ¨"
            ],
            extraÃ±andote: [
                "TÃº dices que me extraÃ±as... Pero yo te extraÃ±o mÃ¡s. Y lo sabes. ğŸ¥ºâ¤ï¸",
                "La distancia solo hace que te quiera mÃ¡s. ğŸ’«",
                "OjalÃ¡ pudiera abrazarte ahora mismo. ğŸ’–",
                "Cierro los ojos y te imagino aquÃ­ conmigo. ğŸŒ™",
                "Cada dÃ­a sin ti es un dÃ­a menos para verte otra vez. â³ğŸ’›",
                "Si pudiera teletransportarme, ya estarÃ­a contigo. ğŸš€ğŸ’•",
                "Contando los dÃ­as, las horas y los minutos para verte. ğŸ•°ï¸ğŸ’–",
                "Te extraÃ±o tanto que hasta el aire parece mÃ¡s pesado sin ti. ğŸ’•",
                "Mi corazÃ³n late diferente cuando no estÃ¡s cerca. ğŸ’˜",
                "ExtraÃ±arte es la parte mÃ¡s difÃ­cil de mi dÃ­a. ğŸ˜”",
                "A veces, desearÃ­a que el tiempo corriera mÃ¡s rÃ¡pido. â³ğŸ’›",
                "Si el amor pudiera acortar distancias, ya estarÃ­amos juntos. ğŸ¥°",
                "No importa dÃ³nde estÃ©s, mi corazÃ³n siempre te sigue. ğŸ’–",
                "Cada dÃ­a sin ti es un pequeÃ±o desafÃ­o que supero con amor. ğŸ’•",
                "OjalÃ¡ pudieras ver cuÃ¡nto te echo de menos. ğŸ’«",
                "Pensar en ti es mi forma de sentirte cerca. ğŸ’›",
                "No importa la distancia, siempre estamos conectados. ğŸŒâœ¨",
                "Aunque no estemos juntos, sÃ© que piensas en mÃ­ como yo en ti. ğŸ¥°",
                "Es difÃ­cil no verte, pero lo que siento por ti lo hace mÃ¡s llevadero. ğŸ’–",
                "A veces, extraÃ±o hasta el sonido de tu voz. ğŸ“ğŸ’•",
                "Si el tiempo pudiera ir mÃ¡s rÃ¡pido cuando no estÃ¡sâ€¦ â³ğŸ’›",
                "Dicen que la ausencia hace crecer el amor, y yo lo siento cada dÃ­a. â¤ï¸",
                "No importa cuÃ¡nto tiempo pase, siempre te extraÃ±arÃ© igual. ğŸ’•",
                "Te pienso tanto que casi parece que estÃ¡s aquÃ­. ğŸ’–",
                "No hay un solo dÃ­a en el que no desee verte. ğŸ¥°",
                "Quisiera que el universo conspirara para juntarnos ahora mismo. ğŸŒŸ",
                "La espera es dura, pero valdrÃ¡ la pena cuando te vea otra vez. ğŸ’«",
                "Si pudiera pedir un deseo, serÃ­a estar contigo ahora. ğŸ’•",
                "A veces, solo quiero cerrar los ojos y que, al abrirlos, estÃ©s aquÃ­. ğŸ˜”",
                "Mientras te extraÃ±o, me consuela saber que tÃº tambiÃ©n piensas en mÃ­. ğŸ’–"
            ],
            pensandoEnTi: [
                "Ahora mismo estaba pensando en tiâ€¦ Aunque en realidad, siempre lo hago. ğŸ¥°",
                "Eres mi pensamiento favorito del dÃ­a. ğŸ’­â¤ï¸",
                "Si supieras cuÃ¡ntas veces pienso en ti al dÃ­a, te asustarÃ­as. ğŸ˜†ğŸ’“",
                "Pensarte se ha vuelto mi pasatiempo favorito. ğŸ’•",
                "Cada pensamiento bonito que tengo, de alguna forma, termina en ti. ğŸŒ¸",
                "A veces, sin darme cuenta, sonrÃ­o porque te estoy recordando. ğŸ˜Šâ¤ï¸",
                "Â¿Sabes lo bonito que es despertar y que mi primer pensamiento seas tÃº? ğŸ’›",
                "Si me pagaran por cada vez que pienso en ti, ya serÃ­a millonario. ğŸ’°ğŸ’•",
                "EstÃ¡s en mis pensamientos como una melodÃ­a que no quiero dejar de escuchar. ğŸ¶",
                "A veces, te imagino aquÃ­ conmigo, y mi dÃ­a se siente mÃ¡s bonito. ğŸŒ·",
                "Me encanta perderme en mis pensamientos cuando el tema eres tÃº. ğŸ’–",
                "Aunque estÃ© ocupado, siempre hay un rinconcito en mi mente reservado para ti. ğŸ§ ğŸ’˜",
                "Â¿CÃ³mo logras habitar mis pensamientos las 24 horas del dÃ­a? ğŸ¤”ğŸ’›",
                "Si el pensamiento pudiera teletransportarme, ya estarÃ­a contigo. ğŸš€ğŸ’–",
                "Hay momentos en los que el mundo se queda en pausaâ€¦ Porque me pierdo pensando en ti. â³ğŸ’•",
                "Si pudiera dibujar mi mente, estarÃ­a llena de recuerdos contigo. ğŸ–Œï¸ğŸ’–",
                "Te pienso tanto que hasta en mis sueÃ±os te apareces. ğŸŒ™ğŸ’«",
                "Â¿Sabes lo que mÃ¡s me gusta de pensar en ti? Que me hace sentir cerca de ti. ğŸ’•",
                "A veces, ni siquiera me doy cuenta de cuÃ¡nto te piensoâ€¦ Hasta que alguien me lo seÃ±ala. ğŸ˜ŠğŸ’–",
                "Si cada pensamiento sobre ti fuera una estrella, el cielo de mi mente estarÃ­a iluminado siempre. âœ¨ğŸŒ™",
                "No hay un solo dÃ­a en el que no aparezcas en mi mente al menos una vez. ğŸ’›",
                "Si el amor se midiera en pensamientos, creo que el mÃ­o por ti es infinito. â™¾ï¸ğŸ’–",
                "Te pienso tanto que siento que el universo ya deberÃ­a habernos juntado. ğŸŒğŸ’•",
                "No sÃ© si eres un pensamiento en mi mente o un latido en mi corazÃ³nâ€¦ QuizÃ¡ ambos. ğŸ’“ğŸ’­",
                "Â¿QuÃ© harÃ© el dÃ­a que te tenga a mi lado y ya no tenga que imaginarte? ğŸ¥ºğŸ’–",
                "Cuando el mundo se pone ruidoso, pensar en ti es mi refugio. ğŸ’•",
                "Me gusta cuando pienso en ti y, de repente, me llega un mensaje tuyo. Â¿ConexiÃ³n? ğŸ˜ğŸ’˜",
                "Cada vez que el dÃ­a se siente difÃ­cil, pensar en ti me da fuerzas. ğŸ’ªğŸ’–",
                "En mi lista de pensamientos importantes, tÃº siempre ocupas el primer lugar. ğŸ¥‡ğŸ’–",
                "A veces, solo quiero decirte: 'Estoy pensando en ti'. ğŸ’­â¤ï¸"
            ],
            conGanasDeVerte: [
                "OjalÃ¡ pudiera verte ahora mismo. Â¿Sabes cuÃ¡nto darÃ­a por eso? MuchÃ­simo. ğŸ’–",
                "Contando los dÃ­as para verte de nuevoâ€¦ Porque cada segundo sin ti es un siglo. â³â¤ï¸",
                "Si pudiera teletransportarme, ya estarÃ­a contigo. ğŸ’«",
                "ExtraÃ±o mirarte a los ojos y perderme en ellos. ğŸ‘€ğŸ’•",
                "El dÃ­a en que te vea otra vez, no te voy a soltar ni un segundo. ğŸ¥°",
                "Quisiera que el universo conspirara para juntarnos ahora mismo. ğŸŒŸ",
                "A veces, todo lo que necesito es verte y abrazarte fuerte. ğŸ¤—ğŸ’–",
                "Si tuviera un deseo, serÃ­a poder verte hoy mismo. âœ¨",
                "No importa cuÃ¡nto tiempo pase, siempre tendrÃ© ganas de verte. ğŸ’›",
                "Contando los segundos para nuestro prÃ³ximo encuentro. â³ğŸ’•",
                "Verte es como un regalo que siempre espero con ansias. ğŸğŸ’–",
                "No hay nada que quiera mÃ¡s ahora mismo que verte y decirte cuÃ¡nto te quiero. ğŸ’˜",
                "Mi dÃ­a no estÃ¡ completo sin verte, aunque sea un ratito. â˜€ï¸ğŸ’•",
                "OjalÃ¡ pudiera robarte un momento y verte aunque sea de lejos. ğŸ‘€ğŸ’–",
                "Si pudiera detener el tiempo cuando estemos juntos, lo harÃ­a sin dudarlo. â³ğŸ’›",
                "Hay muchas cosas que quiero hacerâ€¦ Pero todas empiezan con verte. ğŸ’•",
                "La distancia es cruel cuando lo Ãºnico que quiero es verte sonreÃ­r. ğŸ˜ŠğŸ’–",
                "Â¿Sabes ese vacÃ­o en el pecho? Es porque me faltas tÃº. ğŸ¥ºğŸ’•",
                "Cuando por fin te vea, no querrÃ© despedirme. Nunca. ğŸ’›",
                "Ya no sÃ© quÃ© hacer con tantas ganas de verteâ€¦ ğŸ’•",
                "Si verte fuera un medicamento, lo necesitarÃ­a todos los dÃ­as. ğŸ’ŠğŸ’–",
                "El mejor momento del dÃ­a serÃ¡ cuando por fin estemos frente a frente. ğŸ¥°",
                "No hay nada que me emocione mÃ¡s que la idea de verte de nuevo. ğŸŒŸğŸ’˜",
                "Quisiera que el destino nos diera una sorpresa y nos hiciera coincidir hoy. ğŸ˜ğŸ’•",
                "Cada dÃ­a sin verte es un dÃ­a menos para el reencuentro. â³ğŸ’–",
                "Â¿Y si nos encontramos sin planearlo? SerÃ­a el mejor accidente del mundo. ğŸ˜ğŸ’•",
                "No importa cuÃ¡nto tiempo pase, mis ganas de verte solo crecen. ğŸ’›",
                "Te imagino aquÃ­ conmigo y sonrÃ­o solo de pensarlo. ğŸ˜ŠğŸ’–",
                "Dicen que la espera vale la penaâ€¦ Pero yo ya no quiero esperar. ğŸ¥ºğŸ’•",
                "El dÃ­a en que te vea otra vez, te recordarÃ© cuÃ¡nto te extraÃ±Ã©. â¤ï¸"
            ],
            conGanasDePensar: [
                "Â¿Otra vez con ganas de 'pensar'? ğŸ˜ Buenoâ€¦ Yo tambiÃ©n. â¤ï¸â€ğŸ”¥",
                "Pensar contigo siempre es una buena idea. ğŸ˜‰",
                "Si te digo lo que estoy pensando ahoraâ€¦ ğŸ˜³",
                "A veces siento que tu 'pensar' tiene doble sentido. ğŸ˜",
                "Cuando dices eso, solo me da mÃ¡s curiosidadâ€¦ ğŸ˜†",
                "Me gusta cuando dices que tienes ganas de 'pensar'â€¦ Â¿De quÃ© tipo de pensamiento hablamos? ğŸ˜",
                "Hay pensamientos que deberÃ­an guardarseâ€¦ Pero otros deberÃ­an compartirse. ğŸ¤­",
                "Entre pensar y hacerâ€¦ Solo hay un paso. ğŸ˜",
                "Â¿Seguro que quieres decirme lo que estÃ¡s pensando? ğŸ˜³",
                "No sÃ© si estÃ¡s pensando lo mismo que yoâ€¦ Pero espero que sÃ­. ğŸ˜",
                "Tu forma de pensar me encanta. ğŸ’–",
                "Si lo que piensas es lo que imaginoâ€¦ Entonces sÃ­. ğŸ˜",
                "A veces, 'pensar' es solo una excusa. ğŸ˜‰",
                "Me encanta cuando te pones en modo pensativa. ğŸ˜",
                "Pensar contigo es peligrosoâ€¦ Pero me encanta. ğŸ˜",
                "Hay pensamientos que no deberÃ­an decirseâ€¦ Pero contigo quiero compartirlos todos. ğŸ˜‰",
                "Â¿De verdad estÃ¡s pensando eso? Porque yo tambiÃ©n. ğŸ˜†",
                "Me pregunto si tu 'pensar' se parece al mÃ­oâ€¦ ğŸ˜",
                "Si estÃ¡s pensando lo que creoâ€¦ ğŸ‘€",
                "Â¿Segura que solo quieres 'pensar'? ğŸ˜"
            ]
        };

        const poemas = [
            "ENTRE NÃšMEROS Y LETRAS\n\nEntre nÃºmeros y letras\nsurgiÃ³ una rosa en una libreta.\nEntre ecuaciones y canciones\nsurgieron nuestros amores.",
            "TOMA MI MANO\n\nToma mi mano,\ny acompÃ¡Ã±ame al camino\nde la vida.\n\nToma mi mano,\ny recorramos la senda,\nde por vida.",
            "ES IMPOSIBLE OCULTARTE\n\nEs imposible ocultar que estoy enamorado\nÂ¿CÃ³mo esconder lo tanto que te amo?\nPuedo intentar moderarme con todas mis ganas\nPero resulta que tu encanto siempre me gana.",
            "TU LLEGADA\n\nComo un destello de luz\nfue tu llegada a mi vida.\nEl amor a mi lado,\ny yo no enterado.\n\nTu esplendor trastornÃ³\ntodo mi interior,\ny enamorarte\nfue mi gran pasiÃ³n.\n\nTu sonrisa en mis ojos\nme estremeciÃ³,\ny mi reflejo en tus ojos\nme venciÃ³.\n\nNo sÃ© cuÃ¡ndo ni cÃ³mo\nme enamorÃ©,\npero la gran lecciÃ³n\npude aprender.",
            "No hace falta ir lejos\npara hallar el amor.\nTu llegada a mi vida\nme lo demostrÃ³.\n\nPuede ser instantÃ¡neo,\no en un momento surgir;\npero cuando se siembra,\nva a persistir.",
            "HÃBLAME\n\nHÃ¡blame por favor.\nNo dejes el silencio\nconsumir mi interior.\n\nNo dejes este fuego,\ny su ardor,\nperder la pasiÃ³n.",
            "CUANDO TE VEO\n\nCuando te veo,\nno sÃ© quiÃ©n soy.\nCuando te veo,\nfluye el amor.\nCuando te veo,\nÂ¡quÃ© pasiÃ³n!\n\nCuando te veo,\nsalta el corazÃ³n.",
            "NO SÃ‰ CÃ“MO\n\nNo sÃ© cuÃ¡ndo ni cÃ³mo\nse encendiÃ³ una chispa en mÃ­.\nNo sÃ© cuÃ¡ndo ni cÃ³mo\nme enamorÃ© de ti.\n\nDicen que el amor ciego es,\ny por eso Cupido no ve,\npero yo ahora puedo verlo\nen tu sonrisa sin placer.",
            "TE QUIERO\n\nNo sabes tÃº\ncuÃ¡nto anhelo\ndecirte te quiero.\nMirarte a los ojos,\ny con corazÃ³n sincero,\nexpresarte mi deseo.",
            "AMOR... Â¿CORRESPONDIDO?\n\nEstoy enamorado,\ny no sÃ© por quÃ©.\nQuizÃ¡s no es mi deseo,\nno lo puedo entender.\nPero tu rostro es lo que veo,\ny no te veo en Ã©l.\nAhÃ­ no estÃ¡ la imagen\nque de ti representÃ©.\n\nQuÃ© momento de placer,\ncuando te veo aparecer.\nTodo se detiene,\npero no parece fiel.\nNo dejo de mirarte,\ny con disimulo proceder,\ninhibiendo lo que siento,\ny con miedo de perder.",
            "Con miedo de perderte a ti,\nde perder tu neonatal,\nde que no seas para mÃ­,\nde no importante a ti.\n\nCorresponde hoy a mi amor,\ncorresponde a esta pasiÃ³n,\ncorresponde hoy al deseo\nque hay en mi corazÃ³n.\n\nConcÃ©deme tu sonrisa,\ny el instante que no corra yo por ti,\ncoro tÃº por mÃ­.",
            "NO DEJO DE PENSAR EN TI\n\nNo dejo de pensar en ti,\ny hasta me estoy preocupando.\nÂ¿SerÃ¡ solo una obsesiÃ³n?\nÂ¿O en realidad es amor?\n\nTÃº me has hecho ver estrellas,\ny transformado mi pensar.\n\nAhora no lo entienden ni ellas...\nÂ¿Por ti loco debo estar?",
            "Â¿ME QUIERES?\n\nTe quiero,\npero parece que no me quieres.\nMas vuelvo a quererte,\ny de repente creo que me quieres.\nÂ¿SerÃ¡ una simple cosa ilusoria,\no es una verdad notoria?\n\nÂ¿En verdad me quieres,\no solo mi esperanza mantienes?\nÂ¡CÃ³mo quisiera saber\ntu corazÃ³n, conocerlo.\n\nÂ¿En verdad me quieres?\nÂ¿O solo me retienes?\nNo comprendo tu reacciÃ³n,\ny a veces me trastorno,\npero hay un rayo de luz,\nque despierta mi canciÃ³n.\n\nPara tu corazÃ³n es un adorno\nque del mÃ­o proviene:\nalmas gemelas conectadas,\ny por la eternidad enlazadas.",
            "DESTINO\n\nVoy soplado del destino\ndonde este quiera guiarme.\nY si me lleva contigo,\ncon gusto he de aceptarle.",
            "QUÃ‰ DIFÃCIL ES DEJAR DE PENSAR EN TI\n\nQuÃ© difÃ­cil es dejar de pensar en ti;\nquÃ© difÃ­cil es abandonar ese momento.\nÂ¡Dan ganas de poder detener el tiempo!, para transitar.\nPero el fluir nunca se detiene,\nAvanza rÃ¡pido y sin perdÃ³n.\nOh, segundos de mi corazÃ³n,\nÂ¡multiplicaos por causa del amor!",
            "TE VEO Y NO TE VEO\n\nTe veo y no te veo.\nY cuando te veo,\nno sÃ© por quÃ© te veo.\nY si te dejo de ver,\nparece que voy a perecer,\nluego te quiero volver a ver.",
            "TE VEO DIFERENTE\n\nTe veo diferente,\ny no sÃ© quÃ© es lo que sientes.\nPero me imagino tu mente\ny creo que no mientes.\nParezco correspondido,\ny amado con motivo\npor la mejor rosa entre los vivos.\nÂ¡La mÃ¡s bonita que he conocido!",
            "DESEO CUMPLIDO\n\nHoy se cumpliÃ³ ese deseo,\ny te dije que te quiero.\nHoy vivimos el momento\nen que expresamos los sentimientos.\nHoy pude acercarme a ti\npara mi corazÃ³n traducir.\nY fue una nueva muy feliz\nsaber que pensabas igual de mÃ­.",
            "SINCERIDAD\n\nSinceridad, es lo que todos queremos.\nÂ¿Quieres que sea sincero?\n\nAnhelo que te recuestes de mi pecho.\nAnhelo hilar mi mano entre tus dedos.\nAnhelo acariciar tu dulce pelo.\nLo que eres, anhelo conocerlo.",
            "QUÃ‰ IMPACTO\n\nQuÃ© impacto tuvo mi ser\ncuando tu entrada pude ver.\nTanta hermosura de repente\nque no sabÃ­a responder mi mente.\n\nQuÃ© hermosa estÃ¡s siempre,\ny hoy me sorprendiste nuevamente.\nTu belleza me cautiva,\nen un segundo cambias mi ambiente.\n\nCuando te saludÃ©... Â¿CÃ³mo he de hacerte frente?\nDe mi enamoramiento eso es una prueba patente.\nEres grandiosa, y cada dÃ­a es algo creciente.\nPreciosa, Â¡cÃ³mo me encantas! Eso es evidente.",
            "EN EL AMOR NADIE MANDA\n\nEn el amor nadie manda.\nY cuando menos te lo esperas,\na tu puerta llama.\nMuy sutilmente comienza.\nY aunque abrirle no quieras.",
            "ASÃ ES LA VIDA\n\nAsÃ­ es la vida.\nA veces es buena,\na veces compleja.\nAsÃ­ es la vida.\nA veces es bella,\na veces novela.\nAsÃ­ es la vida.\nDe repente tierna,\ny en un momento te atropella.\nAsÃ­ es la vida.\nPero desde que estÃ¡s tÃº,\nno hago mÃ¡s que ver estrellas.",
            "EL INFINITO EN TUS OJOS\n\nEstaba anocheciendo\ncuando de repente pensÃ©:\nÂ«Hoy no he dejado mi poema,\nÂ¡ni un segundo mÃ¡s tardarÃ©!Â».\nCon pasiÃ³n me apresurÃ©,\ny la pluma fuerte agarrÃ©.\nNo sabÃ­a quÃ© iba a hacer,\ny en la luna terminÃ©.\n\nY contemplÃ© desde las alturas\nla hermosura de la tierra,\ny a un segundo luz de distancia\nuna luz resplandeciente y bella.\n\nEn la oscuridad estaba ella,\nalumbrando como todo un sol.\nY con su enorme destello\ntraspasaba mi corazÃ³n.",
            "Para analizar su enorme esplendor\ntuve que sacar mi telescopio.\nY acercÃ¡ndome al mÃ¡ximo\nahora deseaba un microscopio.\nSu estilo Ãºnico y propio\npudo despertar mis escritos.\nY desde aquel observatorio,\ndisfrutÃ© en sus ojos el infinito.",
            "CUANDO ESTOY CONTIGO\n\nCuando estoy contigo,\nse desvanece el tiempo.\nCuando estoy contigo,\ndisfruto cada momento.\nCuando estoy contigo,\namor es lo que siento.\nCuando estoy contigo,\ntodo es una eternidad.\nCuando estoy contigo,\nparece que la vida se detendrÃ¡.\nPero cuando estoy contigo,\nesa eternidad velozmente se va.",
            "DICEN QUE EL AMOR...\n\nDicen que el amor te hace ver estrellas,\npero yo solo veo una.\nDicen que sientes muchas maripositas,\npero yo solo siento una.\nDicen que quieres muchas sonrisas,\npero yo solo quiero una.\nDicen que entonces se regalan rosas,\npero yo solo anhelo una:\nA mi estrella, mi mariposita, mi sonrisa.",
            "Â¿ES ETERNO?\n\nÂ¿Es eterno\neste fuego de amor que siento?\nÂ¿Es eterno\neste rÃ­o de pasiÃ³n que tengo?\nÂ¿Es eterna\nesta llama que arde en mi corazÃ³n?\nÂ¿Es eterna\nnuestra conexiÃ³n de amor?",
            "LATIDO DEL CORAZÃ“N\n\nUnas lÃ¡grimas rodean mi rostro,\nrecorren la faz sin piedad.\nHay una distancia entre nosotros,\nÂ¿pero cuÃ¡l serÃ¡ nuestro parar?\n\nEsa figura llega a mi interior,\nintensifica el latir del corazÃ³n.\nComo si fuera un sencillo cantor,\nque con su rima transmite amor.\n\nÂ¿Pero quÃ© es eso tan deseado,\nque todos tiemblan si lo oyen?\nNo es solo querer y arrancar,\nes proteger y saber cuidar.",
            "QUEBRANTO\n\nNo sabes cÃ³mo me siento,\ny yo no sÃ© cÃ³mo te sientes.\nÂ¿Estos son esos momentos\nen los que desearÃ­as parar el tiempo?\nÂ¿O simplemente son suspiros\nque te gustarÃ­a no hubieran ocurrido?\n\nEn medio de la alegrÃ­a inmensa\nse forma una profunda tristeza.\nÂ¿Acaso al final de esta senda\nencontrarÃ¡s cerrada la puerta?\nÂ¿O esa pequeÃ±a lÃ¡grima de dolor\nestÃ¡ condenada a sufrir prisiÃ³n?\n\nNo sÃ© el objeto de este quebranto,\npero en vano no serÃ¡ el llanto.\nÂ¿Miras al cielo y ves azul eterno?\nÂ¿O miras al sol y ves amarillo alegre?\nÂ¿O acaso las nubes de la densa lluvia\nhan cubierto tu paisaje de penuria?",
            "CARPE DIEM\n\nHay tantas cosas que el corazÃ³n desea decir.\nHay tantas cosas que el corazÃ³n desea hacer.\nHay tantas cosas que anhelamos conseguir.\nHay tantas cosas que anhelamos tener,\nque muchas veces nos olvidamos del carpe diem.",
            "VIAJE\n\nHoy te fuiste de viaje,\nmi sol.\nCon una maleta de flores,\ny un girasol.\nÂ¿QuÃ© pasarÃ¡? Pensaba mi alma,\nÂ¡quÃ© dolor!\nTodavÃ­a no se ha ido,\ny ya extraÃ±o su calor.\nPero ve, disfruta y aprende\ncon amor,\nque seguiremos uniendo\nnuestro corazÃ³n.",
            "TE EXTRAÃ‘O\n\nNo estamos a la distancia\nde la tierra a la luna,\npero este muchachito\nextraÃ±a tu ternura.\nÂ«Â¿QuÃ© serÃ¡ de mis ricitos?Â»\nme pregunto sin parar,\ny nunca dejo de soÃ±ar,\nni en tu belleza pensar.",
            "EN MEDIO DEL SILENCIO\n\nAun en medio del silencio\nse escucha una hermosa voz.\nA paradoja parece esto,\npero es mÃ¡s que una pasiÃ³n.\n\nAun en medio del silencio\nnoto tu mano en mis labios.\nEstÃ¡s frenando el desenfreno...\nÂ«Shhhh, solo calla de AmorÂ».",
            "HOY ME ADELANTO YO\n\nÂ¿Y si hoy me adelanto yo?\nÂ¿Y si hoy me tomo el atrevimiento,\nde otra vez mis pensamientos,\ndejarlos inscritos en tu corazÃ³n?\n\nLo harÃ©, y serÃ¡ como una canciÃ³n.\n\nYa casi mi lenguaje son los versos,\nquiero que su luz siempre brille.\nY crÃ©eme no serte molesto,\nsino escuchar de ti un Â«Â¿Â¡QuÃ© dices!?Â»\n\nÂ¿Y si me tomo la valentÃ­a\nde mirar por mi ventana\nel anÃ¡lisis de muchas estrellas,\nque resplandecen en la nada?\nLo harÃ©, sÃ© que eres una de ellas.\n\nSiempre quieres ser la primera\ncon esa sonrisa tan sincera.\nÂ¿Pero si hoy yo soy el primero,\nen decirte que te quiero?",
            "Ganaremos los dos, lo sÃ©,\ny ninguno perderÃ¡, tambiÃ©n lo sÃ©.\nPor lo que seguiremos ganando tÃº y yo.\nAsÃ­ que, triste no estÃ©s: te quiero con fervor.",
            "Â¿CÃ“MO PIENSO EN TI!\n\nPienso en mÃ­,\ny pienso en ti.\nPienso en mi mente\ny pienso en ti.\nPienso en mi corazÃ³n,\ny pienso en ti.\nPienso en mi tiempo,\ny pienso en ti.\nPienso en todo,\ny, claro estÃ¡, pienso en ti.",
            "TUS DULCES MANOS\n\nTus dulces manos,\ndeleitosas como las teclas de un piano\ncuando conoces sus secretos\ny no las tocas en vano.\nAgradables como la melodÃ­a\nde una grata sinfonÃ­a\ny codiciables como los manjares\nen las grandes compaÃ±Ã­as.\nTus dulces manos,\ncautivadoras mÃ¡s que el mar,\ntan relajantes que mi corazÃ³n\nhacen derramar.",
            "NARCISO\n\nEl narciso es una flor hermosa,\npero no tanto como mi rosa.\nNarciso se cree el mÃ¡s bello aquÃ­,\nal menos quiere creerlo asÃ­.\nÂ¿Acaso sabe que te conocÃ­?\nPorque Ã©l no se compara a ti.",
            "JUGUEMOS AL INFINITO\n\nÂ¿Quieres jugar al infinito...?\nÂ¿En serio deseas hacerlo?\nAdmiro mucho tu solicitud,\nmas querida, el infinito eres tÃº.",
            "INEXORABLE\n\nInexorable,\nes este amor que siento por ti.\nInevitable,\npalpitar veloz y olvidar el existir.\nIndescriptible,\nla flecha que atravesÃ³ mi corazÃ³n.\nIrresistible,\nver tu rostro y Malcolm el amor.",
            "CUENTA LOS DÃAS\n\nCuenta los dÃ­as, hazlo.\nCuenta el paso del reloj.\nVerÃ¡s en ellos los escritos\nque de mi corazÃ³n son los gritos.\nUno en cada paso,\ny poca serÃ­a la cifra,\npara anunciar al mundo entero\ncÃ³mo mi ser por ti suspira.",
            "Â¿POR QUÃ‰ SUFRO?\n\nSi te quiero, Â¿por quÃ© sufro?\nSi me quieres, Â¿por quÃ© duele?\nÂ«Â¿Acaso el amor y el dolor son dos cosas gemelas?Â»\nTonterÃ­a no es,\nporque he vivido los dos contigo.\n\nQuizÃ¡ es ese deseo de no herir\ntu dulce corazÃ³n\ncon promesas hoy encendidas\ny maÃ±ana de cenizas revestidas.\nQuizÃ¡ es la duda de mi mente\ndiciÃ©ndose\nÂ«Â¿acaso es la elecciÃ³n correcta?Â»\nQuizÃ¡ es el temor de mi ser\na lo que dirÃ¡n al ver\na dos jovencitos apasionados,\nsin entender lo que viven,\nsimplemente enamorados.\n\nPor quÃ© sufro,\nsi has flechado mi corazÃ³n.\nPor quÃ© duele,\nquizÃ¡ sea la herida de tu flecha.\nAmada, es cierto que duele y quebranta...\nAÃºn asÃ­: aquÃ­ hay un corazÃ³n que te ama.",
            "TAUTOLOGÃA\n\nTautologÃ­a,\npalabras antes para mÃ­ desconocida.\nTautologÃ­a,\nser circular y redundancia sin medida.\nTautologÃ­a,\nÂ¿sabes quÃ© es esa palabra en mi vida?\nTautologÃ­a es decir siempre que te quiero,\naunque ya haya dicho lo mucho que te querÃ­a.",
            "BRECHA\n\nTe escribo desde el otro lado,\natravesando el abismo del olvido.\nDesde donde el amor aflora,\ny las emociones no tienen morada.\n\nTe escribo desde el precipicio,\nal lÃ­mite de todo lo prohibido.\nNo atendiendo la profundidad,\ny mostrando la debilidad.\n\nÂ¿AsÃ­ tiene que ser la autoridad?\nÂ¡Si esto lo sufre toda la humanidad!\nSolo busco un poco de intimidad,\nMcCarthy de por de.\nEs intensa la velocidad,\npero en mi corazÃ³n no hay maldad.",
            "Te escribo desde ese mismo lugar\ndonde los sueÃ±os se vuelven realidad.\nDesde donde salen las palabras\nlimitadas por las etapas.\nTe escribo desde dentro,\ny con la mirada en lo alto.\nTe saludan mis ojos,\nque solo esbozan tu belleza.\n\nYo veo tus ojitos... SÃ­,\nlos que describen el infinito.\nTe escribo desde mi corazÃ³n,\ny directo a tu interior.\nÂ¿CÃ³mo fingir, cÃ³mo inhibir,\nÂ¡cÃ³mo mentir!?\nÂ¿CÃ³mo esconder lo que siento por ti?\n\nMultitud de pensamientos\nno lo han podido conseguir.\nLo siento, pero la vida es asÃ­.",
            "Â¿CÃ³mo dejar de decir\nlo que tÃº despertaste en mÃ­?\n\nTe escribo... Te hablo aun sin voz.\nSi alguien no lo entiende...\nLo siento, el amor me tocÃ³.",
            "ROSAS VACÃAS\n\nMultitud de rosas\nen un jardÃ­n encantado.\nMultitud de flores\npara un jardÃ­n desesperado.\nÂ¿Acaso todas huelen igual?\nÂ¿Acaso todas son asÃ­ de hermosas?\n\nPienso, y ninguna serÃ¡ igual.\nMedito, y ninguna tendrÃ¡ la misma fragancia.\nMi rosa sÃ­ tiene encanto,\ny benditos son sus pÃ©talos.\nSus espinas incluso confortan;\nmi rosa, ninguna con su valor.",
            "MIRAR TUS OJOS\n\nMirarte a los ojos\ny transmitir amor.\nMirarte a los ojos\ny ver tu corazÃ³n.\nMirarte a los ojos\ny escuchar tu clamor.\nMirarte a los ojos,\nmucho mÃ¡s que pasiÃ³n.\nMirarte a los ojos\ny quererte siempre.\nÂ¿QuiÃ©n lo entiende?\nSolo tÃº y yo.",
            "MI CIELO\n\nTÃº eres el cielo de mi vida.\nAl verte, todas las estrellas giran.\nTu imagen, siempre alumbra mis dÃ­as.\nTu voz, la mÃ¡s dulce y tierna melodÃ­a.\nTÃº, tÃº eres mi mejor compaÃ±Ã­a.\nSÃ­, tÃº eres el cielo de mi vida.",
            "NO SABÃA QUE DOLÃA TANTO\n\nNo sabÃ­a que dolÃ­a tanto.\nNo imaginaba este quebranto.\nVer traspasado mi corazÃ³n\npor la supuesta alegrÃ­a del amor.\nEstar rodeado y a la vez solo,\nmientras tiene lugar el desarrollo.\n\nSuelen decir que el amor trae paz,\npero eso no ha resultado eficaz.\n\nOh, quisiera decir que mientras escribo\ngozo es lo Ãºnico que cultivo.\nPero mÃ¡s honda la herida percibo,\nÂ¿cÃ³mo llegÃ³ hasta aquÃ­? Â¿CuÃ¡l fue su camino?\nOh, si los demÃ¡s pudieran entender\nque siento mÃ¡s que un simple querer.\nAl menos una figura traducir,\nque mi corazÃ³n no piensa en maldecir.",
            "Oh, si escucharan de mi interior el canto...\nOtra vez lo digo, solo estoy enamorado.",
            "PIENSO EN TI\n\nPienso en ti donde estÃ©.\nY cuando no estoy, pienso en ti.\nEres el recuerdo de mi amor,\ny tambiÃ©n el de mi dolor.\n\nPero pienso en ti, y disfruto.\nY cuando no, pienso en ti.\nEsta es mi vida por ahora, asÃ­:\nSolo me queda pensar en ti.",
            "NO ROMPAS EL CORAZÃ“N\n\nDicen que dos corazones unidos...\nPor cierto, Â¿quÃ© es el amor entre nosotros?\nDifÃ­cilmente son separados.\nÂ¿Sabes que te quiero?\nNo importa que estÃ©n entristecidos,\nÂ¿Te gusta mirar las estrellas en la soledad?\nPorque su vÃ­nculo ya ha sido establecido.\nÂ¿Disfrutas el resplandor de la luna atravesar tu ventana?\nNo rompas nuestras canciones.\nÂ¿Sabes que nuestro corazÃ³n atraviesa?",
            "Â¿SIGUES TENIENDO ALAS?\n\nÂ¿Sigues sintiÃ©ndolo?\nÂ¿Sigues estando radiante?\nÂ¿Tu corazÃ³n sigue teniendo alas?\nÂ¿Sigues teniendo las ansias?\nÂ¿Sigues viendo el milagro de tus sueÃ±os?\nÂ¿TodavÃ­a existe el calor?\nÂ¿Permanecen tus melodÃ­as?\nÂ¿TodavÃ­a sigue nuestra sinfonÃ­a?\nÂ¿O se supone que no debÃ­a haber ninguna?\nÂ¿O nosotros, inmaduros,\nvivimos nuestro sueÃ±o de luna?\nÂ¿TodavÃ­a puede componer el cantor?\nÂ¿Sigue brillando eso que llamamos Â«amorÂ»?",
            "ENTENDÃ LO DIFÃCIL\n\nAl principio parecÃ­a hermoso;\nluego se miraba escandaloso.\nDespuÃ©s seguÃ­a lo glorioso,\nsegÃºn los ritos religiosos.\n\nMas en la experiencia, silencioso,\nel transcurso vivÃ­a, nervioso.\n\nQuerÃ­a mostrarme respetuoso,\nempero terminaba contencioso.\nComo todo un cuidadoso,\nquerÃ­a vencer lo doloroso.\n\nMas entendÃ­ que el comienzo amoroso,\ntambiÃ©n puede ser desamoroso.",
            "ESOS JUEGUITOS\n\nÂ¿DÃ³nde estÃ¡n esos jueguitos\nque jugÃ¡bamos toditos?\nÂ¿DÃ³nde estÃ¡n esos momentos\nen que ignorÃ¡bamos el tiempo?\nÂ¿DÃ³nde estÃ¡n esos dÃ­as\nque nos hacÃ­an gozar y tanto?\n\nParece que se perdieron en el rincÃ³n del tiempo.\nEse tiempo que una mirada nos hizo querernos.\nPero no creo que estÃ©n perdidos,\nsimplemente estÃ¡n escondidos.\nEsperan a alguien que los encuentre,\ny los saque a brillar nuevamente.",
            "UN ABRAZO\n\nCÃ³mo extraÃ±o ese instante\nen el que el tiempo se detiene.\nDonde se juntan nuestras visiones\ny saltan los corazones.\nDonde la ilusiÃ³n del contacto\nse convierte en realidad.\nÂ¿DÃ³nde estÃ¡n esos momentos\nen los que oÃ­mos el Â«te quieroÂ»?",
            "RECUERDO VACÃO\n\nUn destello deslumbrante\na la distancia se asoma.\nUn recuerdo en el vacÃ­o\ncomo un reflejo levitante.\n\nFlores, perlas y mariposas\nadornan una casa Barbosa.\nÂ«Venid, entrad y aspirad;\nllenad este cÃ­rculo tan vacÃ­oÂ»\nÂ¿Esto tiene significado?\n\nPuede ser un lugar reservado.\nUn vacÃ­o en un alma sedienta\nesperando ser saciado.\n\nFlores, perlas y mariposas\nadornan una casa arteriosa.\nLos destellos, como luces cariÃ±osas,\nla hacen cada vez mÃ¡s hermosa.",
            "INTRUSIÃ“N\n\nMente viva en un momento desviada.\nPierde su pensamiento sin entender nada.\nSolo es fruto de la intrusiÃ³n, camarada;\nesa figura en tu mente, apasionada.\n\nParece que en ti se ha quedado abandonada,\ncomo si nada mÃ¡s existiera, ahÃ­ condenada.\n\nPara tus sentimientos se vuelve una espada,\nmientras buscas el fin de esa jornada.\nEntonces tu alma se pregunta ansiosa:\nÂ«Â¿CÃ³mo caÃ­ en esta trampa envenenada?Â»\nLa doncella que te extendÃ­a la llamada\nresultÃ³ ser simplemente la camada.\n\nMas cuando quieres abandonar esa parada,\nno te resistes ante una nueva mirada.\nLa llama vuelve a la intensidad adecuada,\ny se prepara a esperar: Â«Â¿cuÃ¡ndo serÃ¡ la bajada?Â»",
            "LA LUNA COMO NUNCA\n\nHe visto la luna como nunca antes.\nTan brillante y cÃ¡lida como el sol.\nHe visto cÃ³mo deslumbra su reflejo,\ncapaz de despertar el corazÃ³n.\nHe visto cÃ³mo con su mirada\nllora y expresa mucho dolor,\nal traer a memoria aquellos dÃ­as\nen que yo admiraba su expresiÃ³n.\n\nÂ¡QuÃ© inocencia la de mi luna!\nNo conoce mi intenciÃ³n.\nNo me he olvidado de ella,\naÃºn le compongo mi canciÃ³n."
        ];
        while (poemas.length < 365) {
            poemas.push(poemas[Math.floor(Math.random() * poemas.length)]);
        }

        function obtenerDiaDelAÃ±o() {
            const ahora = new Date();
            const inicioAÃ±o = new Date(ahora.getFullYear(), 0, 1);
            const diferencia = ahora - inicioAÃ±o;
            return Math.floor(diferencia / (1000 * 60 * 60 * 24));
        }

        function obtenerPoemaDiario() {
            const hoy = new Date().toISOString().split("T")[0];
            const clave = `poema-${hoy}`;
            let poemaGuardado = localStorage.getItem(clave);
            if (!poemaGuardado) {
                const diaDelAÃ±o = obtenerDiaDelAÃ±o();
                poemaGuardado = poemas[diaDelAÃ±o];
                localStorage.setItem(clave, poemaGuardado);
            }
            return poemaGuardado;
        }

        function mostrarPoema() {
            const poema = obtenerPoemaDiario();
            document.getElementById("poema").innerText = poema;
        }

        function obtenerFraseDiaria(emocion) {
            const hoy = new Date().toISOString().split("T")[0];
            const clave = `frase-${emocion}-${hoy}`;
            let fraseGuardada = localStorage.getItem(clave);
            if (!fraseGuardada) {
                const frasesDisponibles = frases[emocion];
                fraseGuardada = frasesDisponibles[Math.floor(Math.random() * frasesDisponibles.length)];
                localStorage.setItem(clave, fraseGuardada);
            }
            return fraseGuardada;
        }

        function mostrarMensaje() {
            const emocion = document.getElementById("emocion").value;
            const mensaje = obtenerFraseDiaria(emocion);
            document.getElementById("mensaje").innerText = mensaje;
            incrementarContadorEmocion(emocion);
        }

        document.getElementById("password").addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                event.preventDefault();
                document.getElementById("login").click();
            }
        });
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, push, onChildAdded, get, set, onValue, serverTimestamp, onDisconnect } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAcweOs5qS3v4xbzmkYCFLKxVaSWVsly_M",
            authDomain: "estrellita-chl.firebaseapp.com",
            databaseURL: "https://estrellita-chl-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "estrellita-chl",
            storageBucket: "estrellita-chl.firebasestorage.app",
            messagingSenderId: "1006618062076",
            appId: "1:1006618062076:web:8cc3a6bb3ebe800d11fb79",
            measurementId: "G-X2K8ZCR608"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth();
        const db = getDatabase(app);

        const USUARIO_ESTRELLITA = "oras5982";
        const USUARIO_ADMIN = "jahaziel.alvarezreyes";

        let inactivityTimer;
        let usuarioActual = "";
        let loginTime = null;

        function cargarEmailJS() {
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js';
            script.onload = function() {
                window.emailjs.init('FK-l7zhLUb3b7Ah2X');
            };
            document.head.appendChild(script);
        }
        cargarEmailJS();

        function enviarNotificacionAcceso(usuario) {
            if (window.emailjs) {
                window.emailjs.send('service_mrtsxqh', 'template_xypee8k', {
                    from_name: usuario,
                    message: "Ha iniciado sesiÃ³n en la aplicaciÃ³n",
                    date: new Date().toLocaleString()
                }).then(function(response) {
                    console.log('NotificaciÃ³n de acceso enviada:', response.status, response.text);
                }, function(error) {
                    console.error('Error al enviar notificaciÃ³n:', error);
                });
            }
        }

        function inicializarNotificacionesMensajes() {
            onChildAdded(ref(db, "mensajes"), function (snapshot) {
                const data = snapshot.val();
                if (data.usuario === "Estrellita" && usuarioActual !== USUARIO_ADMIN) {
                    enviarCorreo(data.usuario, data.mensaje, data.fecha);
                }
            });
        }

        function inicializarEstadoConexion() {
            const estadoRef = ref(db, "estadoUsuarios/Estrellita");
            if (usuarioActual === USUARIO_ESTRELLITA) {
                set(estadoRef, true);
                onDisconnect(estadoRef).set(false);
                enviarNotificacionAcceso("Estrellita");
            }
            onValue(estadoRef, (snapshot) => {
                const conectado = snapshot.val();
                console.log("Estado de Estrellita:", conectado ? "Conectada" : "Desconectada");
                if (conectado && usuarioActual === USUARIO_ADMIN) {
                    mostrarNotificacionLocal("Â¡Estrellita ha iniciado sesiÃ³n!");
                }
            });
        }

        function enviarCorreo(usuario, mensaje, fecha) {
            if (window.emailjs) {
                window.emailjs.send('service_mrtsxqh', 'template_xypee8k', {
                    from_name: usuario,
                    message: mensaje,
                    date: fecha
                }).then(function(response) {
                    console.log('Correo enviado:', response.status, response.text);
                }, function(error) {
                    console.error('Error al enviar correo:', error);
                });
            }
        }

        function mostrarNotificacionLocal(mensaje) {
            if (Notification.permission === "granted") {
                new Notification("Estrellita App", { body: mensaje });
            } else if (Notification.permission !== "denied") {
                Notification.requestPermission().then(permission => {
                    if (permission === "granted") {
                        new Notification("Estrellita App", { body: mensaje });
                    }
                });
            }
        }

        const listaEmociones = [
            { value: "feliz", label: "Feliz ğŸ˜Š" },
            { value: "triste", label: "Triste ğŸ˜”" },
            { value: "estresada", label: "Estresada ğŸ˜µâ€ğŸ’«" },
            { value: "cansada", label: "Cansada ğŸ¥±" },
            { value: "extraÃ±andote", label: "ExtraÃ±Ã¡ndote ğŸ¥º" },
            { value: "pensandoEnTi", label: "Pensando en ti ğŸ’­â¤ï¸" },
            { value: "conGanasDeVerte", label: "Con ganas de verte ğŸ¥°" },
            { value: "conGanasDePensar", label: "Con ganas de 'pensar' ğŸ˜" }
        ];

        function obtenerNombreUsuario(email) {
            return email.split('@')[0].toLowerCase();
        }

        function obtenerNombreMostrado(email) {
            const usuario = obtenerNombreUsuario(email);
            return usuario === USUARIO_ESTRELLITA ? "Estrellita" : "Luna";
        }

        function registrarAcceso(usuario) {
            if (usuario === USUARIO_ESTRELLITA) {
                const accessLogRef = ref(db, "accesos");
                push(accessLogRef, {
                    usuario: usuario,
                    timestamp: serverTimestamp(),
                    fecha: new Date().toLocaleString(),
                    inicio: new Date().getTime()
                });
                loginTime = new Date().getTime();
            }
        }

        function registrarTiempoSesion(usuario) {
            if (usuario === USUARIO_ESTRELLITA && loginTime !== null) {
                const sessionEndTime = new Date().getTime();
                const sessionDuration = (sessionEndTime - loginTime) / 1000 / 60;
                const sessionLogRef = ref(db, "tiempoSesiones");
                push(sessionLogRef, {
                    usuario: usuario,
                    timestamp: serverTimestamp(),
                    fecha: new Date().toLocaleString(),
                    duracionMinutos: sessionDuration.toFixed(2),
                    inicio: new Date(loginTime).toLocaleString(),
                    fin: new Date().toLocaleString()
                });
                loginTime = null;
            }
        }

        function inicializarContadoresEmociones() {
            const contadoresRef = ref(db, "contadores");
            get(contadoresRef).then((snapshot) => {
                if (!snapshot.exists()) {
                    const contadoresIniciales = {};
                    listaEmociones.forEach(emocion => {
                        contadoresIniciales[emocion.value] = 0;
                    });
                    set(contadoresRef, contadoresIniciales);
                }
            }).catch(error => {
                console.error("Error al inicializar contadores:", error);
            });

            const usuario = obtenerNombreUsuario(auth.currentUser.email);
            usuarioActual = usuario;
            actualizarInfoAdmin(usuario);

            const contadorElement = document.getElementById("contador-emociones");
            const historialElement = document.getElementById("historial-emociones");

            if (usuario === USUARIO_ADMIN) {
                console.log("Â¡Usuario administrador detectado!", usuario);
                contadorElement.style.display = "block";
                historialElement.style.display = "block";
                onValue(contadoresRef, (snapshot) => {
                    if (snapshot.exists()) {
                        const contadores = snapshot.val();
                        actualizarUIContadores(contadores);
                    }
                });
                inicializarHistorialEmociones();
            } else {
                console.log("Usuario no administrador:", usuario);
                contadorElement.style.display = "none";
                historialElement.style.display = "none";
            }
        }

        function actualizarInfoAdmin(usuario) {
            const adminInfoPanel = document.getElementById("admin-info");
            const usuarioNombre = document.getElementById("usuario-nombre");
            const adminStatus = document.getElementById("admin-status");

            if (usuario === USUARIO_ADMIN) {
                adminInfoPanel.style.display = "block";
                usuarioNombre.textContent = usuario;
                adminStatus.textContent = "SÃ­";
                adminStatus.style.color = "green";
            } else {
                adminInfoPanel.style.display = "none";
            }
        }

        function actualizarUIContadores(contadores) {
            const contenedor = document.getElementById("contadores-container");
            contenedor.innerHTML = "";
            listaEmociones.forEach(emocion => {
                const contador = contadores[emocion.value] || 0;
                const div = document.createElement("div");
                div.className = "contador-item";
                div.innerHTML = `
                    <span class="contador-label">${emocion.label}:</span>
                    <span class="contador-valor">${contador}</span>
                `;
                contenedor.appendChild(div);
            });
        }

        window.incrementarContadorEmocion = function(emocion) {
            if (usuarioActual === USUARIO_ESTRELLITA) {
                console.log(`Registrando emociÃ³n: ${emocion} para ${usuarioActual}`);
                const contadorRef = ref(db, `contadores/${emocion}`);
                get(contadorRef).then((snapshot) => {
                    const valorActual = snapshot.exists() ? snapshot.val() : 0;
                    set(contadorRef, valorActual + 1).then(() => {
                        console.log(`Contador de ${emocion} actualizado a ${valorActual + 1}`);
                    }).catch(error => {
                        console.error("Error al incrementar contador:", error);
                    });
                }).catch(error => {
                    console.error("Error al leer contador:", error);
                });

                const historialEmocionesRef = ref(db, "historialEmociones");
                push(historialEmocionesRef, {
                    emocion: emocion,
                    usuario: usuarioActual,
                    timestamp: serverTimestamp(),
                    fecha: new Date().toLocaleString()
                }).then(() => {
                    console.log(`EmociÃ³n ${emocion} registrada en historial`);
                }).catch(error => {
                    console.error("Error al registrar historial:", error);
                });
            }
        };

function inicializarHistorialEmociones() {
            console.log("Inicializando historial de emociones para administrador");
            const historialRef = ref(db, "historialEmociones");
            onValue(historialRef, (snapshot) => {
                console.log("Datos de historial recibidos:", snapshot.val());
                if (snapshot.exists()) {
                    actualizarUIHistorial(snapshot.val());
                }
            });
        }

        function actualizarUIHistorial(historial) {
            const contenedor = document.getElementById("historial-container");
            contenedor.innerHTML = "";
            const historialArray = Object.entries(historial).map(([key, value]) => ({
                id: key,
                ...value
            }));
            historialArray.sort((a, b) => b.timestamp - a.timestamp); // Ordenar por timestamp descendente
            historialArray.forEach(evento => { // Mostrar todas las entradas sin lÃ­mite
                const nombreEmocion = listaEmociones.find(e => e.value === evento.emocion)?.label || evento.emocion;
                const div = document.createElement("div");
                div.className = "historial-item";
                div.innerHTML = `
                    <span>${nombreEmocion}</span>
                    <span style="float: right; font-style: italic; font-size: 0.9em;">${evento.fecha}</span>
                `;
                contenedor.appendChild(div);
            });
        }

        document.getElementById("togglePassword").addEventListener("click", function () {
            const passwordInput = document.getElementById("password");
            if (passwordInput.type === "password") {
                passwordInput.type = "text";
                this.innerText = "ğŸ™ˆ";
            } else {
                passwordInput.type = "password";
                this.innerText = "ğŸ‘";
            }
        });

        function resetInactivityTimer() {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                registrarTiempoSesion(usuarioActual);
                signOut(auth).then(() => {
                    document.getElementById("contenido").style.display = "none";
                    document.getElementById("loginContainer").style.display = "block";
                    alert("SesiÃ³n cerrada por inactividad");
                });
            }, 5 * 60 * 1000);
        }

        document.getElementById("login").addEventListener("click", function () {
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;
            const loginError = document.getElementById("loginError");

            loginError.textContent = "";

            signInWithEmailAndPassword(auth, email, password)
            .then((userCredential) => {
                document.getElementById("loginContainer").style.display = "none";
                document.getElementById("contenido").style.display = "block";
                resetInactivityTimer();
                usuarioActual = obtenerNombreUsuario(userCredential.user.email);
                console.log("Inicio de sesiÃ³n exitoso. Usuario:", usuarioActual);
                registrarAcceso(usuarioActual);
                inicializarContadoresEmociones();
            })
            .catch((error) => {
                console.error("Error al iniciar sesiÃ³n:", error);
                switch(error.code) {
                    case 'auth/invalid-email': loginError.textContent = "El correo electrÃ³nico no es vÃ¡lido."; break;
                    case 'auth/user-not-found': loginError.textContent = "No se encontrÃ³ un usuario con este correo."; break;
                    case 'auth/wrong-password': loginError.textContent = "La contraseÃ±a es incorrecta."; break;
                    case 'auth/too-many-requests': loginError.textContent = "Demasiados intentos. Intenta mÃ¡s tarde."; break;
                    default: loginError.textContent = "Error al iniciar sesiÃ³n: " + error.message;
                }
            });
        });

        document.getElementById("email").addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                event.preventDefault();
                document.getElementById("password").focus();
            }
        });

        document.getElementById("logout").addEventListener("click", function () {
            registrarTiempoSesion(usuarioActual);
            signOut(auth).then(() => {
                document.getElementById("contenido").style.display = "none";
                document.getElementById("loginContainer").style.display = "block";
                usuarioActual = "";
            }).catch((error) => {
                console.error("Error al cerrar sesiÃ³n:", error);
                alert("Error al cerrar sesiÃ³n: " + error.message);
            });
        });

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById("loginContainer").style.display = "none";
                document.getElementById("contenido").style.display = "block";
                resetInactivityTimer();
                usuarioActual = obtenerNombreUsuario(user.email);
                console.log("Usuario detectado en cambio de estado:", usuarioActual);
                registrarAcceso(usuarioActual);
                inicializarContadoresEmociones();
            } else {
                document.getElementById("loginContainer").style.display = "block";
                document.getElementById("contenido").style.display = "none";
                usuarioActual = "";
                loginTime = null;
            }
        });

        document.addEventListener("mousemove", resetInactivityTimer);
        document.addEventListener("keydown", resetInactivityTimer);

        document.getElementById("mensajeInput").addEventListener("keydown", function(event) {
            // Enter agrega salto de lÃ­nea
        });

        let mensajesMostrados = new Set();

        function mostrarMensaje(data) {
            if (data.key && mensajesMostrados.has(data.key)) return;

            const chat = document.getElementById("chat");
            const mensajeElemento = document.createElement("div");
            mensajeElemento.classList.add("mensaje-item");

            if (data.key) {
                mensajesMostrados.add(data.key);
                mensajeElemento.setAttribute("data-id", data.key);
            }

            const nombreMostrado = sanitizarTexto(data.usuario || "Usuario");
            const mensajeSanitizado = sanitizarTexto(data.mensaje);
            const mensajeFormateado = mensajeSanitizado.replace(/\n/g, '<br>');
            mensajeElemento.innerHTML = `<p><strong>${nombreMostrado}:</strong> ${mensajeFormateado}</p>`;
            chat.appendChild(mensajeElemento);
            chat.scrollTop = chat.scrollHeight;
        }

        function cargarMensajesIniciales() {
            const mensajesRef = ref(db, "mensajes");
            mensajesMostrados.clear();
            const chat = document.getElementById("chat");
            chat.innerHTML = "";

            get(mensajesRef).then((snapshot) => {
                if (snapshot.exists()) {
                    const mensajes = [];
                    snapshot.forEach((childSnapshot) => {
                        mensajes.push({
                            key: childSnapshot.key,
                            ...childSnapshot.val()
                        });
                    });

                    mensajes.sort((a, b) => {
                        if (a.timestamp && b.timestamp) return a.timestamp - b.timestamp;
                        return new Date(a.fecha) - new Date(b.fecha);
                    });

                    mensajes.forEach(mensaje => mostrarMensaje(mensaje));
                }
                window.cargaInicialCompletada = true;
            }).catch(error => {
                console.error("Error al cargar mensajes:", error);
                window.cargaInicialCompletada = true;
            });
        }

        function sanitizarTexto(texto) {
            const div = document.createElement('div');
            div.textContent = texto;
            return div.innerHTML;
        }

        function inicializarReceptorMensajes() {
            const mensajesRef = ref(db, "mensajes");
            window.cargaInicialCompletada = false;
            cargarMensajesIniciales();

            onChildAdded(mensajesRef, function (snapshot) {
                if (window.cargaInicialCompletada) {
                    const data = snapshot.val();
                    mostrarMensaje({
                        key: snapshot.key,
                        ...data
                    });
                }
            });
        }

        document.getElementById("enviarMensaje").addEventListener("click", function () {
            const user = auth.currentUser;
            if (!user) return;

            const mensajesRef = ref(db, "mensajes");
            const mensaje = document.getElementById("mensajeInput").value.trim();

            if (mensaje) {
                const nuevoMensaje = {
                    emailCompleto: user.email,
                    usuario: obtenerNombreMostrado(user.email),
                    mensaje: mensaje,
                    fecha: new Date().toLocaleString(),
                    timestamp: new Date().getTime()
                };

                document.getElementById("mensajeInput").value = "";
                const newRef = push(mensajesRef);
                const messageId = newRef.key;

                mostrarMensaje({
                    key: messageId,
                    ...nuevoMensaje
                });

                set(newRef, nuevoMensaje).catch((error) => {
                    console.error("Error al enviar mensaje:", error);
                });

                resetInactivityTimer();
            }
        });

        window.addEventListener('beforeunload', function() {
            registrarTiempoSesion(usuarioActual);
        });

        document.addEventListener('DOMContentLoaded', function() {
            mensajesMostrados = new Set();
            inicializarEstadoConexion();
            inicializarNotificacionesMensajes();
            inicializarReceptorMensajes();
        });
    </script>
</body>
</html>
